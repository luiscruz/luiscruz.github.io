---
layout: post
author: Lu√≠s Cruz
title: "The role of education in Green Software and how to get started. Branch."
# image: "img/blog/2021-branch/og_image.png"
show_image: False
mermaid: False
equation: False
draft: True
invisible: True
summary: "bla bla bla"
---

<span class="first-letter">S</span>a. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

importance of green software

Education is key

Universities play an important role in .
Inniatives that universities can do .

In particular educating the next generation of software engineers

Being a tech professional implies being constantly reducating yourself on the latest new tool or technique.
Unfortunately there is not a lot of content when it comes to the development of energy-efficient software applications. 
But of course you don't need to go back to the university.

Regardless of whether you are an educator, student, software developer, or simply a tech enthusiast there is one thing skill you need to master: **measuring the energy consumption of your software**.

One of the first things that enthusiasts about green software need to learn is how to measure the energy consumption of your software.

Doing it is far from trivial. First, there is a myriad of factors that affect energy consumption making it difficult to compute the exact energy consumption entailed by executing a single software. This is especially worrisome when you are comparing different versions of a software ‚Äî you need to make sure you are comparing the energy consumption entailed by your software and not by anything else running in your computer. Second, there are many tools out there, but there is no one-size-fits-all solution. Some tools only work with specific operative systems, hardware, etc. 

But don't worry: this article gets you covered. Let's start with the list of things you need to fix before starting measuring:

1. **Stop all unnecessary tasks üßòüèæ‚Äç‚ôÄÔ∏è**. Before measuring, all other applications should be closed, notifications should be off, only required hardware should be connected and, if you don't need internet for the measurement, your computer should be offline.  
2. **Freeze your settings ü•∂**. Sometimes, you cannot completely stop all the things that are unrelated to your software. Hence, make sure you freeze all the settings ‚Äì for example, the brightness of your screen should be the same in all the measurements.
3. **Warm up your setup üì∂**. Energy consumption is highly affected by the temperature of your hardware. Hence, always do a small warm-up before running experiments.
4. **Sleep between measurements ‚è∏**. After the execution of a given program, your computer will still incur into residual energy consumption that stemmed from its execution. This is commonly named as *tail energy consumption*. To prevent the tail energy consumption from affecting the results of a subsequent execution, do a short pause between measurements. 
5. **Control room temperature üå°**. The temperature affects energy consumption. Hence, make sure you have the same room temperature for all the measurements.
6. **Repeat measurements a few times üîÅ**. Despite all efforts to avoid errors, energy measurement are still prone to random variations. This means that it could happen that a new version of your software is perceived as more or less energy efficient just because of these random variations in the energy consumption. The only way we can fix that is by repeating measurements until results look consistent. This is illustrated in the animation below: the first measurement indicates that version `B` is less efficient than `A`; after repeating the measurements, we see that version `B` spends roughly less 20 joules than `A`. 

![Violin plots](/img/blog/2021-branch/repeat.mp4){: class="center-block" width="500px" }
<p class="caption" markdown="span">Plot of the distribution of energy consumption for versions `A` and `B`. In each iteration we add another round of measurements (depicted with the new blue circles). When we reach iteration 30, it is clear that version B is more energy efficient. On average version `A` uses 100 joules and version `B` uses 80 joules, yielding a 20% improvement. [View source][Plots source].</p>

{:start="7"}
7. **Create automated executions ü§ñ**. If we want to repeat measurements, they should be repeatable. No better way to do this than by automating executions. This is typically done with common software testing tools. 
8. **Shuffle measurements üîÄ**. Instead of executing all the measurements for a given version and then all the measurements for another version, it is recommended to randomly shuffle the executions. This way, we prevent any unexpected (yet unnoticeable) measurement error from affecting only one of the versions being tested.

Keep in mind, though, that **these guidelines should not discourage you from measuring energy consumption**. My advice is that you **start simple** ‚Äî no automation, repetitions, etc. ‚Äì only a simple first result to give some intuition. That is more than enough to start discussing the energy consumption of your software and to get your colleagues into it.

Nevertheless, if you really want your team to use energy results consistently, you will need to cover all these guidelines eventually.
Failing to adopt them will lead to something that software engineers often call **flakiness**: when two executions of the same test produce different results. The problem of flaky tests is that developers will stop worrying when tests fail ‚Äì making tests useless.


So now that you know all the basics about measuring energy consumption, there is one last thing you need to master: collecting energy consumption data. In the old days, one could only measure energy consumption using special hardware with physical power sensors. Now, we have several tools that provide reliable power estimations. The easiest and most accessible energy measurement tool I have come across is the [Intel Power Gadget]. It provides a handy graphical interface, and anyone can use this tool with only little tech skills.

Here's how to use it:

1. **Install it** üì•. via the official website:<br/> [https://software.intel.com/content/www/us/en/develop/articles/intel-power-gadget.html][IntelPowerGadget]

2. **Open it** üìÇ. The interface shows a few plots with `CPU utilisation (%)`, `Frequency (GHz)`, `Temperature (¬∫C)`, and `Power (W)`.

![Intel Power Gadget Interface](/img/blog/2021-07-20/intel-power-gadget.png){: class="center-block" width="400px" }

{:start="3"}
3. **Start collecting** üîã. You simply have to click on the menu `Logging > Log to File` to start measuring (and once again stop it).

![Intel Power Gadget Start Menu](/img/blog/2021-07-20/intel-power-gadget-menu.png){: class="center-block" width="400px" }

{:start="4"}
4. **Check results** üìä. The power data will be collected and stored in a `CSV` file under your Documents folder (default behaviour). I have run a small test and, in my case, it was stored in `~/Documents/PwrData_2021-2-19_17-16-10.csv`.

When we open the CSV file ‚Äì using, for example, Excel ‚Äì you find several columns. Some are straightforward ‚Äì e.g., `System Time`, `Elapsed Time (sec)`, `Processor Power_0(Watt)` ‚Äì while others tend to be more complex ‚Äì e.g., `RDTSC` and `GT Requsted Frequency(MHz)`.

Let's not worry too much about it. If you scroll all the way down to the bottom of the file, there is a summary table with a few important attributes:

- **Total Elapsed Time (sec)**. The total time in seconds in which power data was being collected.
- **Cumulative Package Energy_0 (Joules)**. The total energy consumption of the processor.
- **Cumulative DRAM Energy_0 (Joules)**. The total energy consumption of the volatile memory.

![Intel Power Gadget Data](/img/blog/2021-07-20/intel-power-gadget-data.png){: class="center-block" width="400px" }


**And that's it**! You have made your first energy measurement!

Keep in mind however, that the main strength of the Power Gadget is also its main weakness: the graphical interface is really easy to use but it is not so simple if you want to automate executions. Command-line interfaces are more suitable for that scenario. There are a few alternatives out there. Check [this article][energy tools] if you need to use a different energy measurement tool.

[Plots source]: https://colab.research.google.com/drive/1DmFuBwhs9wI4_6zaaUh5B1rTiVt-hNt9?usp=sharing
[IntelPowerGadget]: https://software.intel.com/content/www/us/en/develop/articles/intel-power-gadget.html
[energy tools]: https://luiscruz.github.io/2021/07/20/measuring-energy.html


Questions to Michelle:

- tone! is it okay?
- links to external articles? should I have a list of resources at the bottom?
- flow! I'm going from education to practical tools. Is it flowing?

